<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>5-Minute Multifamily Analyzer</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0B6E4F">
  <link rel="stylesheet" href="style.css">
  <script>
    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').catch(console.error);
      });
    }
  </script>
</head>
<body>
<header>
  <h1>5-Minute Multifamily Analyzer</h1>
  <p class="tag">Dave Lindahl-style quick screen • Momentum first, reposition second</p>
</header>

<main>
  <section class="card">
    <h2>Deal Basics</h2>
    <div class="grid">
      <label>Units <input type="number" id="units" value="100" min="1"></label>
      <label>Avg Rent / mo <input type="number" id="avgRent" value="1200" min="0" step="1"></label>
      <label>Other Income / mo (total) <input type="number" id="otherInc" value="0" min="0" step="1"></label>
      <label>Occupancy % <input type="number" id="occ" value="95" min="0" max="100" step="0.1"></label>
      <label>Purchase Price ($) <input type="number" id="price" value="12000000" min="0" step="1000"></label>
      <label>Acq. Costs % <input type="number" id="acqPct" value="2" min="0" max="10" step="0.1"></label>
      <label>Initial CapEx ($) <input type="number" id="initialCapex" value="0" min="0" step="1000"></label>
    </div>
  </section>

  <section class="card">
    <h2>Expenses</h2>
    <div class="toggle-row">
      <span>Mode:</span>
      <label class="switch">
        <input type="checkbox" id="expMode">
        <span class="slider"></span>
      </label>
      <span id="expModeLabel">Expense Ratio</span>
    </div>
    <div id="expRatioRow" class="grid">
      <label>Expense Ratio % of EGI <input type="number" id="expRatio" value="50" min="0" max="100" step="0.1"></label>
    </div>
    <div id="expPerDoorRow" class="grid hidden">
      <label>Expenses $/door/yr <input type="number" id="expPerDoor" value="6200" min="0" step="50"></label>
    </div>
  </section>

  <section class="card">
    <h2>Debt Assumptions</h2>
    <div class="grid">
      <label>LTV % <input type="number" id="ltv" value="70" min="0" max="90" step="0.1"></label>
      <label>Rate % <input type="number" id="rate" value="6.5" min="0" max="20" step="0.01"></label>
      <label>Amort (yrs) <input type="number" id="amort" value="25" min="1" max="40"></label>
      <label>I/O Years (optional) <input type="number" id="ioYears" value="0" min="0" max="10"></label>
    </div>
  </section>

  <section class="card">
    <h2>Targets (Trinity)</h2>
    <div class="grid">
      <label>Cap Rate Target ≥ <input type="number" id="capTarget" value="5.5" min="0" step="0.1"></label>
      <label>CoC Target ≥ <input type="number" id="cocTarget" value="8" min="0" step="0.1"></label>
      <label>DSCR Target ≥ <input type="number" id="dscrTarget" value="1.4" min="1" step="0.01"></label>
    </div>
    <div class="profiles">
      <div class="grid">
        <label>Profile Name <input type="text" id="profileName" placeholder="e.g., Columbus B/C+"></label>
        <div class="profile-buttons">
          <button id="saveProfile" type="button">Save Profile</button>
          <button id="deleteProfile" type="button">Delete</button>
        </div>
        <label>Load Profile
          <select id="profileSelect"></select>
        </label>
        <div class="preset-buttons">
          <button class="preset" data-cap="5.5" data-coc="8" data-dscr="1.4">Lindahl Default</button>
          <button class="preset" data-cap="6.0" data-coc="9" data-dscr="1.5">Conservative</button>
          <button class="preset" data-cap="5.0" data-coc="7" data-dscr="1.3">Aggressive</button>
        </div>
      </div>
      <p class="hint">Set any targets you like, save as a profile per market, and switch on the fly.</p>
    </div>
  </section>
    <div class="grid">
      <label>Cap Rate Target ≥ <input type="number" id="capTarget" value="5.5" min="0" step="0.1"></label>
      <label>CoC Target ≥ <input type="number" id="cocTarget" value="8" min="0" step="0.1"></label>
      <label>DSCR Target ≥ <input type="number" id="dscrTarget" value="1.4" min="1" step="0.01"></label>
    </div>
  </section>

  <section class="card actions">
    <button id="analyze">Analyze</button>
    <button id="reset">Reset</button>
    <button id="shareLink">Share</button>
  </section>

  <section id="results" class="card">
    <h2>Results</h2>
    <div class="results-grid">
      <div class="metric"><div class="k">GPR</div><div class="v" id="gprVal">—</div><div class="s">Gross Potential Rent (annual)</div></div>
      <div class="metric"><div class="k">EGI</div><div class="v" id="egiVal">—</div><div class="s">Effective Gross Income</div></div>
      <div class="metric"><div class="k">Opex</div><div class="v" id="opexVal">—</div><div class="s">Operating Expenses</div></div>
      <div class="metric"><div class="k">NOI</div><div class="v" id="noiVal">—</div><div class="s">Net Operating Income</div></div>
      <div class="metric"><div class="k">Cap%</div><div class="v" id="capVal">—</div><div class="s">Cap Rate</div></div>
      <div class="metric"><div class="k">Debt$</div><div class="v" id="debtVal">—</div><div class="s">Loan Amount</div></div>
      <div class="metric"><div class="k">P&I</div><div class="v" id="piVal">—</div><div class="s">Annual Debt Service (P&I)</div></div>
      <div class="metric"><div class="k">DSCR</div><div class="v" id="dscrVal">—</div><div class="s">NOI ÷ Debt Service</div></div>
      <div class="metric"><div class="k">CoC%</div><div class="v" id="cocVal">—</div><div class="s">Cash-on-Cash</div></div>
      <div class="metric"><div class="k">B/E Occ%</div><div class="v" id="beOccVal">—</div><div class="s">Break-even Occupancy</div></div>
      <div class="metric"><div class="k">Cash In</div><div class="v" id="cashInVal">—</div><div class="s">Down + Acq + CapEx</div></div>
    </div>
    <div id="trinity" class="trinity">
      <div><span id="capBadge" class="badge">Cap</span></div>
      <div><span id="cocBadge" class="badge">CoC</span></div>
      <div><span id="dscrBadge" class="badge">DSCR</span></div>
    </div>
    <div class="notes">
      <p><strong>Notes:</strong> NOI excludes CapEx &amp; debt. Expenses can be ratio or $/door/yr. DSCR uses full P&amp;I. Use IO years for cash flow view only.</p>
    </div>
  </section>

  <section class="card">
    <h2>Price Guidance</h2>
    <p class="sub">What price makes the deal meet targets?</p>
    <div class="grid">
      <label>Target DSCR (loan terms above) <input type="number" id="dscrGuide" value="1.25" step="0.01"></label>
      <label>Target Cap Rate <input type="number" id="capGuide" value="6" step="0.1"></label>
    </div>
    <div class="results-grid">
      <div class="metric">
        <div class="k">Max Price (DSCR)</div>
        <div class="v" id="maxPriceDscr">—</div>
        <div class="s">Estimated max price to hit DSCR target</div>
      </div>
      <div class="metric">
        <div class="k">Max Price (Cap)</div>
        <div class="v" id="maxPriceCap">—</div>
        <div class="s">Price at target cap given your NOI</div>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>Quick Tips</h2>
    <ul class="tips">
      <li>Screen fast: if Cap, CoC, and DSCR all fail → pass.</li>
      <li>Momentum deals first (cash-flowing); ≤30% heavy reposition.</li>
      <li>Walk every unit during DD; verify income with bank statements.</li>
      <li>Target B/B- assets, avoid D-class headaches.</li>
      <li>$1 rent increase ≈ $10 value at a 10% cap; scale to your market cap.</li>
    </ul>
  </section>

  <footer>
    <button id="saveState">Save</button>
    <button id="clearState">Clear</button>
    <span class="muted">v1.0 • Works offline • Made for phone use</span>
  </footer>
</main>

<script src="app.js"></script>
</body>
</html>
